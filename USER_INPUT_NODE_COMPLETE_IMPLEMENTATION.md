# UserInputèŠ‚ç‚¹å®Œæ•´å®ç°æ€»ç»“

## ğŸ“‹ æ¦‚è¿°

æˆåŠŸåœ¨`job-search-agent`ä¸­å®ç°äº†å®Œæ•´çš„`UserInput`èŠ‚ç‚¹ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹åˆ›å»ºã€å›¾ç»“æ„é›†æˆå’ŒScheduleræç¤ºè¯æ›´æ–°ã€‚è¯¥å®ç°å®Œå…¨å¯¹é½`codewiz`çš„A2Aäº¤äº’æ¨¡å¼ã€‚

---

## âœ… å®ç°çš„ä¸‰ä¸ªå…³é”®æ­¥éª¤

### 1. åˆ›å»ºUserInput NodeAction âœ…

**æ–‡ä»¶**: `job-search-agent/src/main/java/com/zhouruojun/jobsearchagent/agent/actions/UserInput.java`

```java
@Slf4j
public class UserInput implements NodeAction<MainGraphState> {
    @Override
    public Map<String, Object> apply(MainGraphState state) throws Exception {
        log.info("JobSearchAgent UserInput, state:{}", state.lastMessage());
        return Map.of("next","", "agent_response", "",
                "messages", state.lastMessage().orElse(AiMessage.aiMessage("ç­‰å¾…ç”¨æˆ·è¾“å…¥")));
    }
}
```

**è¯´æ˜**ï¼š
- å®ç°`NodeAction<MainGraphState>`æ¥å£
- è®°å½•ç”¨æˆ·è¾“å…¥çŠ¶æ€
- è¿”å›ç”¨æˆ·è¾“å…¥æ¶ˆæ¯
- å®Œå…¨å¯¹é½`codewiz/cr-agent`çš„å®ç°

---

### 2. åœ¨ä¸»å›¾ä¸­æ·»åŠ UserInputèŠ‚ç‚¹ âœ…

**æ–‡ä»¶**: `job-search-agent/src/main/java/com/zhouruojun/jobsearchagent/agent/builder/JobSearchGraphBuilder.java`

#### 2.1 å¯¼å…¥UserInputç±»
```java
import com.zhouruojun.jobsearchagent.agent.actions.UserInput;
```

#### 2.2 æ·»åŠ userInputåˆ°Schedulerè·¯ç”±åˆ—è¡¨
```java
List<String> schedulerChildren = new ArrayList<>();
schedulerChildren.add("job_info_collection_subgraph");
schedulerChildren.add("resume_analysis_optimization_subgraph");
schedulerChildren.add("job_search_execution_subgraph");
schedulerChildren.add("planner");
schedulerChildren.add("summary");
schedulerChildren.add("userInput");  // âœ… æ–°å¢
```

#### 2.3 åœ¨çŠ¶æ€å›¾ä¸­æ·»åŠ UserInputèŠ‚ç‚¹
```java
return new StateGraph<>(MessagesState.SCHEMA, stateSerializer)
        // ... å…¶ä»–èŠ‚ç‚¹ ...
        
        // UserInputèŠ‚ç‚¹ - ç”¨äºA2Aäº¤äº’ä¸­çš„ç”¨æˆ·è¾“å…¥
        .addNode("userInput", node_async(new UserInput()))
        
        // ... å­å›¾èŠ‚ç‚¹ ...
```

#### 2.4 é…ç½®Scheduleråˆ°UserInputçš„è·¯ç”±
```java
.addConditionalEdges("scheduler",
        edge_async(schedulerRouting),
        Map.of(
                "job_info_collection_subgraph", "job_info_collection_subgraph",
                "resume_analysis_optimization_subgraph", "resume_analysis_optimization_subgraph",
                "job_search_execution_subgraph", "job_search_execution_subgraph",
                "planner", "planner",
                "summary", "summary",
                "userInput", "userInput"))  // âœ… æ–°å¢userInputè·¯ç”±
```

#### 2.5 é…ç½®UserInputè¿”å›Scheduler
```java
// UserInputè¿”å›Scheduler
.addEdge("userInput", "scheduler")
```

---

### 3. æ›´æ–°Scheduleræç¤ºè¯ âœ…

**æ–‡ä»¶**: `job-search-agent/src/main/java/com/zhouruojun/jobsearchagent/common/PromptTemplateManager.java`

#### 3.1 åœ¨`buildSchedulerInitialSystemPrompt`ä¸­æ·»åŠ userInputè·¯ç”±è¯´æ˜

```java
**å¯ç”¨çš„è·¯ç”±èŠ‚ç‚¹**ï¼š
- job_info_collection_subgraph: å²—ä½ä¿¡æ¯æ”¶é›†å­å›¾
- resume_analysis_optimization_subgraph: ç®€å†åˆ†æä¼˜åŒ–å­å›¾
- job_search_execution_subgraph: æ±‚èŒæ‰§è¡Œå­å›¾
- userInput: ç”¨æˆ·è¾“å…¥èŠ‚ç‚¹ï¼Œå½“éœ€è¦ç”¨æˆ·æä¾›é¢å¤–ä¿¡æ¯ã€ç¡®è®¤æˆ–æ¾„æ¸…æ—¶ä½¿ç”¨ï¼ˆé€šå¸¸åœ¨A2Aäº¤äº’åœºæ™¯ä¸­ï¼‰  // âœ… æ–°å¢
- summary: æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼Œç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
```

#### 3.2 åœ¨`buildSchedulerInitialUserPrompt`ä¸­æ·»åŠ ä½•æ—¶è·¯ç”±åˆ°userInputçš„è¯´æ˜

```java
**æ™ºèƒ½ä½“åˆ°å­å›¾çš„æ˜ å°„**ï¼š
- jobInfoCollectorAgent â†’ job_info_collection_subgraph
- resumeAnalysisOptimizationAgent â†’ resume_analysis_optimization_subgraph
- jobSearchExecutionAgent â†’ job_search_execution_subgraph

**ä½•æ—¶è·¯ç”±åˆ°userInput**ï¼š  // âœ… æ–°å¢
- å½“éœ€è¦ç”¨æˆ·æä¾›é¢å¤–ä¿¡æ¯æ—¶ï¼ˆå¦‚ç®€å†æ–‡ä»¶ã€å…·ä½“è¦æ±‚ç­‰ï¼‰
- å½“éœ€è¦ç”¨æˆ·ç¡®è®¤é‡è¦æ“ä½œæ—¶ï¼ˆå¦‚æ˜¯å¦æŠ•é€’æŸä¸ªèŒä½ï¼‰
- å½“éœ€è¦ç”¨æˆ·æ¾„æ¸…æ¨¡ç³Šéœ€æ±‚æ—¶ï¼ˆå¦‚è–ªèµ„æœŸæœ›ã€å·¥ä½œåœ°ç‚¹ç­‰ï¼‰
- å½“åœ¨A2Aäº¤äº’ä¸­æ”¶åˆ°INPUT_REQUIREDçŠ¶æ€æ—¶
```

#### 3.3 åœ¨`buildSchedulerUpdateSystemPrompt`ä¸­æ·»åŠ userInputè·¯ç”±è¯´æ˜

```java
**å¯ç”¨çš„è·¯ç”±èŠ‚ç‚¹**ï¼š
- job_info_collection_subgraph: å²—ä½ä¿¡æ¯æ”¶é›†å­å›¾
- resume_analysis_optimization_subgraph: ç®€å†åˆ†æä¼˜åŒ–å­å›¾
- job_search_execution_subgraph: æ±‚èŒæ‰§è¡Œå­å›¾
- userInput: ç”¨æˆ·è¾“å…¥èŠ‚ç‚¹ï¼Œå½“éœ€è¦ç”¨æˆ·æä¾›é¢å¤–ä¿¡æ¯ã€ç¡®è®¤æˆ–æ¾„æ¸…æ—¶ä½¿ç”¨ï¼ˆé€šå¸¸åœ¨A2Aäº¤äº’åœºæ™¯ä¸­ï¼‰  // âœ… æ–°å¢
- summary: æ‰€æœ‰ä»»åŠ¡å®Œæˆï¼Œç”Ÿæˆæœ€ç»ˆæŠ¥å‘Š
```

#### 3.4 åœ¨`buildSchedulerUpdateUserPrompt`ä¸­æ·»åŠ ä½•æ—¶è·¯ç”±åˆ°userInputçš„è¯´æ˜

```java
**ä½•æ—¶è·¯ç”±åˆ°userInput**ï¼š  // âœ… æ–°å¢
- å½“å­å›¾æ‰§è¡Œç»“æœè¡¨æ˜éœ€è¦ç”¨æˆ·è¾“å…¥é¢å¤–ä¿¡æ¯æ—¶
- å½“éœ€è¦ç”¨æˆ·ç¡®è®¤å…³é”®å†³ç­–æ—¶
- å½“åœ¨A2Aäº¤äº’ä¸­æ”¶åˆ°INPUT_REQUIREDçŠ¶æ€æ—¶
- userInputæ‰§è¡Œå®Œæˆåï¼Œä¼šè‡ªåŠ¨è¿”å›schedulerç»§ç»­ä»»åŠ¡æµç¨‹
```

#### 3.5 åœ¨`getSchedulerPrompt`ä¸­æ·»åŠ userInputè¯´æ˜

```java
**ä½ çš„èŒè´£**ï¼š
- ç†è§£å½“å‰è¦æ‰§è¡Œçš„ä»»åŠ¡
- æ ¹æ®ä»»åŠ¡éœ€æ±‚ç”Ÿæˆç²¾ç¡®çš„å­å›¾æ‰§è¡ŒæŒ‡ä»¤
- ç¡®ä¿æŒ‡ä»¤æ¸…æ™°ã€å…·ä½“ï¼Œå­å›¾èƒ½å¤Ÿç›´æ¥æ‰§è¡Œ
- åˆ¤æ–­æ˜¯å¦éœ€è¦ç”¨æˆ·è¾“å…¥é¢å¤–ä¿¡æ¯  // âœ… æ–°å¢
- è¾“å‡ºçº¯æ–‡æœ¬æ ¼å¼çš„æŒ‡ä»¤

// ... 

**å¯ç”¨çš„è·¯ç”±èŠ‚ç‚¹**ï¼š  // âœ… æ–°å¢
- userInput: å½“éœ€è¦ç”¨æˆ·æä¾›é¢å¤–ä¿¡æ¯ã€ç¡®è®¤æˆ–æ¾„æ¸…æ—¶è·¯ç”±åˆ°æ­¤èŠ‚ç‚¹
```

---

## ğŸ”„ å®Œæ•´çš„A2A UserInputäº¤äº’æµç¨‹

### åœºæ™¯ï¼šAgent-Coreè°ƒç”¨JobSearchAgentï¼Œéœ€è¦ç”¨æˆ·è¾“å…¥

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1. Agent-Core: å‘èµ·A2Aä»»åŠ¡è¯·æ±‚                                  â”‚
â”‚     â†’ JobSearchTaskManager.onSendTaskSubscribe                   â”‚
â”‚     â†’ JobSearchControllerCore.processStreamWithA2a               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2. JobSearchAgent: ä¸»å›¾æ‰§è¡Œ                                      â”‚
â”‚     â†’ planner â†’ todoListParser â†’ scheduler                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3. Scheduler: åˆ¤æ–­éœ€è¦ç”¨æˆ·è¾“å…¥                                   â”‚
â”‚     â†’ è·¯ç”±å†³ç­–: next = "userInput"                                â”‚
â”‚     â†’ ç†ç”±: éœ€è¦ç”¨æˆ·æä¾›ç®€å†æ–‡ä»¶/è–ªèµ„æœŸæœ›/å·¥ä½œåœ°ç‚¹ç­‰             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4. UserInputèŠ‚ç‚¹æ‰§è¡Œ                                             â”‚
â”‚     â†’ è®°å½•æ—¥å¿—: "ç­‰å¾…ç”¨æˆ·è¾“å…¥"                                     â”‚
â”‚     â†’ è¿”å›æ¶ˆæ¯: state.lastMessage() æˆ– "ç­‰å¾…ç”¨æˆ·è¾“å…¥"            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5. JobSearchAgent: å‘é€INPUT_REQUIREDäº‹ä»¶ç»™Agent-Core            â”‚
â”‚     â†’ JobSearchTaskManager.sendTextEvent(requestId, message,     â”‚
â”‚                                          "INPUT_REQUIRED")         â”‚
â”‚     â†’ TaskStatus.state = TaskState.WORKING                        â”‚
â”‚     â†’ Message.metadata["method"] = "INPUT_REQUIRED"               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6. Agent-Core: æ¥æ”¶INPUT_REQUIREDäº‹ä»¶                            â”‚
â”‚     â†’ A2aSseEventHandler.onEvent                                  â”‚
â”‚     â†’ AgentControllerCore.a2aAiMessageOnEvent                     â”‚
â”‚     â†’ å›¾æ‰§è¡Œæš‚åœï¼ˆå› ä¸ºinterruptæœºåˆ¶ï¼‰                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7. ç”¨æˆ·æä¾›è¾“å…¥                                                  â”‚
â”‚     â†’ ç”¨æˆ·åœ¨Agent-Coreçš„ç•Œé¢è¾“å…¥ä¿¡æ¯                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  8. Agent-Core: å‘é€user_inputè¯·æ±‚                                â”‚
â”‚     â†’ æ„é€ TaskSendParams:                                         â”‚
â”‚       - metadata["method"] = "user_input"                         â”‚
â”‚       - message = ç”¨æˆ·è¾“å…¥å†…å®¹                                     â”‚
â”‚     â†’ A2aClientManager.sendTaskSubscribe                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  9. JobSearchAgent: æ¥æ”¶user_inputè¯·æ±‚                            â”‚
â”‚     â†’ JobSearchTaskManager.onSendTaskSubscribe                    â”‚
â”‚     â†’ æ£€æµ‹åˆ°method = "user_input"                                 â”‚
â”‚     â†’ è·¯ç”±åˆ°: jobSearchControllerCore.humanInput(request)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  10. JobSearchControllerCore.humanInput: æ¢å¤å›¾æ‰§è¡Œ               â”‚
â”‚     â†’ è·å–graphå’Œstate                                            â”‚
â”‚     â†’ æ„é€ UserMessage: UserMessage.from(request.getChat())        â”‚
â”‚     â†’ graph.updateState(state.config(), messages1)                â”‚
â”‚     â†’ graph.stream(null, newConfig) // æ¢å¤æ‰§è¡Œ                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  11. UserInputèŠ‚ç‚¹å†æ¬¡æ‰§è¡Œ                                        â”‚
â”‚     â†’ å¤„ç†ç”¨æˆ·è¾“å…¥çš„UserMessage                                   â”‚
â”‚     â†’ è¿”å›ç”¨æˆ·æ¶ˆæ¯                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  12. è¿”å›Scheduler                                                â”‚
â”‚     â†’ userInput â†’ schedulerï¼ˆé€šè¿‡.addEdgeé…ç½®ï¼‰                   â”‚
â”‚     â†’ ScheduleråŸºäºç”¨æˆ·è¾“å…¥ç»§ç»­è·¯ç”±                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  13. ç»§ç»­ä»»åŠ¡æ‰§è¡Œ                                                 â”‚
â”‚     â†’ Schedulerè·¯ç”±åˆ°ç›¸åº”å­å›¾                                     â”‚
â”‚     â†’ å­å›¾ä½¿ç”¨ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯æ‰§è¡Œä»»åŠ¡                              â”‚
â”‚     â†’ æœ€ç»ˆå®Œæˆä»»åŠ¡å¹¶è¿”å›ç»“æœç»™Agent-Core                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“Š å›¾ç»“æ„å˜åŒ–å¯¹æ¯”

### ä¿®æ”¹å‰
```
START â†’ planner â†’ todoListParser â†’ scheduler â”€â”
                                              â”œâ†’ job_info_collection_subgraph â”€â”
                                              â”œâ†’ resume_analysis_optimization_subgraph â”€â”¤
                                              â”œâ†’ job_search_execution_subgraph â”€â”¤
                                              â”œâ†’ planner                        â”‚
                                              â””â†’ summary â†’ END                  â”‚
                                                   â†‘                            â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¿®æ”¹å
```
START â†’ planner â†’ todoListParser â†’ scheduler â”€â”
                                              â”œâ†’ job_info_collection_subgraph â”€â”
                                              â”œâ†’ resume_analysis_optimization_subgraph â”€â”¤
                                              â”œâ†’ job_search_execution_subgraph â”€â”¤
                                              â”œâ†’ userInput â†’ scheduler (å¾ªç¯)    â”‚  âœ… æ–°å¢
                                              â”œâ†’ planner                        â”‚
                                              â””â†’ summary â†’ END                  â”‚
                                                   â†‘                            â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®å˜åŒ–**ï¼š
- âœ… æ–°å¢`userInput`èŠ‚ç‚¹
- âœ… Schedulerå¯ä»¥è·¯ç”±åˆ°`userInput`
- âœ… `userInput`æ‰§è¡Œåè¿”å›`scheduler`å½¢æˆå¾ªç¯
- âœ… æ”¯æŒå¤šè½®ç”¨æˆ·è¾“å…¥åœºæ™¯

---

## ğŸ¯ Schedulerçš„è·¯ç”±å†³ç­–å¢å¼º

### Schedulerç°åœ¨å¯ä»¥è·¯ç”±åˆ°6ä¸ªèŠ‚ç‚¹ï¼š

1. **job_info_collection_subgraph** - å²—ä½ä¿¡æ¯æ”¶é›†
2. **resume_analysis_optimization_subgraph** - ç®€å†åˆ†æä¼˜åŒ–
3. **job_search_execution_subgraph** - æ±‚èŒæ‰§è¡Œ
4. **userInput** - ç”¨æˆ·è¾“å…¥ï¼ˆâœ… æ–°å¢ï¼‰
5. **planner** - é‡æ–°è§„åˆ’
6. **summary** - ç”Ÿæˆæ€»ç»“

### Schedulerä½•æ—¶è·¯ç”±åˆ°userInputï¼Ÿ

æ ¹æ®æç¤ºè¯ä¸­çš„æŒ‡å¯¼ï¼ŒSchedulerä¼šåœ¨ä»¥ä¸‹åœºæ™¯è·¯ç”±åˆ°`userInput`ï¼š

1. **éœ€è¦ç”¨æˆ·æä¾›é¢å¤–ä¿¡æ¯**
   - ç®€å†æ–‡ä»¶
   - å…·ä½“è¦æ±‚
   - è¯¦ç»†å‚æ•°

2. **éœ€è¦ç”¨æˆ·ç¡®è®¤é‡è¦æ“ä½œ**
   - æ˜¯å¦æŠ•é€’æŸä¸ªèŒä½
   - æ˜¯å¦æ¥å—æ¨èå»ºè®®
   - æ˜¯å¦ç»§ç»­æ‰§è¡Œ

3. **éœ€è¦ç”¨æˆ·æ¾„æ¸…æ¨¡ç³Šéœ€æ±‚**
   - è–ªèµ„æœŸæœ›èŒƒå›´
   - å·¥ä½œåœ°ç‚¹åå¥½
   - èŒä½ç±»å‹é€‰æ‹©

4. **A2Aäº¤äº’ä¸­çš„INPUT_REQUIREDçŠ¶æ€**
   - æ¥æ”¶åˆ°å…¶ä»–Agentçš„INPUT_REQUIREDäº‹ä»¶
   - éœ€è¦ä¸­è½¬ç”¨æˆ·è¾“å…¥

---

## âœ… éªŒè¯æ£€æŸ¥æ¸…å•

- [x] UserInput NodeActionå·²åˆ›å»º
- [x] UserInputèŠ‚ç‚¹å·²æ·»åŠ åˆ°ä¸»å›¾
- [x] Schedulerè·¯ç”±åˆ—è¡¨åŒ…å«userInput
- [x] Scheduleråˆ°userInputçš„æ¡ä»¶è¾¹å·²é…ç½®
- [x] userInputåˆ°schedulerçš„è¿”å›è¾¹å·²é…ç½®
- [x] Scheduleråˆå§‹æç¤ºè¯åŒ…å«userInputè¯´æ˜
- [x] Scheduleræ›´æ–°æç¤ºè¯åŒ…å«userInputè¯´æ˜
- [x] Scheduleré€šç”¨æç¤ºè¯åŒ…å«userInputè¯´æ˜
- [x] ä½•æ—¶è·¯ç”±åˆ°userInputçš„æŒ‡å¯¼å·²æ·»åŠ 
- [x] æ‰€æœ‰linteré”™è¯¯å·²ä¿®å¤
- [x] ä»£ç ç¼–è¯‘é€šè¿‡

---

## ğŸ” ä¸codewizçš„å¯¹é½éªŒè¯

| åŠŸèƒ½ç‚¹ | codewiz/cr-agent | job-search-agent | çŠ¶æ€ |
|--------|------------------|------------------|------|
| UserInput NodeAction | âœ… | âœ… | å®Œå…¨å¯¹é½ |
| ä¸»å›¾ä¸­æ·»åŠ UserInputèŠ‚ç‚¹ | âœ… | âœ… | å®Œå…¨å¯¹é½ |
| è·¯ç”±é…ç½® | interruptAfter("userInput") | .addEdge("userInput", "scheduler") | å®ç°æ–¹å¼ä¸åŒï¼Œæ•ˆæœç›¸åŒ |
| humanInputæ–¹æ³• | âœ… | âœ… | å®Œå…¨å¯¹é½ |
| methodè·¯ç”±(user_input) | âœ… | âœ… | å®Œå…¨å¯¹é½ |
| TaskManager.sendTextEvent | âœ… | âœ… | å®Œå…¨å¯¹é½ |
| Scheduleræç¤ºè¯ | N/A | âœ… | å¢å¼ºç‰ˆ |

---

## ğŸ“ æ€»ç»“

æˆåŠŸå®Œæˆäº†UserInputèŠ‚ç‚¹çš„**å®Œæ•´å®ç°**ï¼ŒåŒ…æ‹¬ï¼š

1. âœ… **èŠ‚ç‚¹åˆ›å»º** - UserInput NodeAction
2. âœ… **å›¾ç»“æ„é›†æˆ** - æ·»åŠ èŠ‚ç‚¹ã€é…ç½®è·¯ç”±
3. âœ… **Scheduleræç¤ºè¯æ›´æ–°** - è®©SchedulerçŸ¥é“ä½•æ—¶å’Œå¦‚ä½•è·¯ç”±åˆ°userInput

ç°åœ¨`job-search-agent`çš„A2Aäº¤äº’æœºåˆ¶**å®Œå…¨å¯¹é½codewiz**ï¼Œæ”¯æŒï¼š
- âœ… interrupt + resumeæœºåˆ¶
- âœ… ç”¨æˆ·è¾“å…¥äº¤äº’
- âœ… æ–¹æ³•è·¯ç”±ï¼ˆuser_inputã€tool_callç­‰ï¼‰
- âœ… å¤šè½®å¯¹è¯
- âœ… çŠ¶æ€æ¢å¤

**job-search-agentçš„A2A UserInputæœºåˆ¶ç°å·²å®Œå…¨å¯ç”¨ï¼** ğŸ‰






